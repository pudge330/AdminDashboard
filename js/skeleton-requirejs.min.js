define(["bglib"],function(i){var a={modules:{},load:function(){var e,t=this;for(e in t.modules)t.loadModule(e);this.__loaded=!0;for(var n=0;n<t.__onloadCallbacks.length;n++)t.__onloadCallbacks[n]()},loadModule:function(e){var t=this;t.modules.hasOwnProperty(e)&&t.modules[e].initWidgets&&t.modules[e].initWidgets()},__loaded:!1,__onloadCallbacks:[],onLoad:function(e){this.__loaded?e():this.__onloadCallbacks.push(e)}};return a.modules.Base=i.EventModule.extend({$el:void 0,constructor:function(){var e;arguments[0]&&(i.DT.isObject(e=arguments[0]||{})||(e={el:e}),this.$el=e.el,i.EventModule.apply(this,[e]))},initialized:function(){return"loaded"==this.$el.getAttribute("data-state")},setState:function(e){this.$el.setAttribute("data-state",e)},getState:function(e){return this.$el.getAttribute("data-state")}},{load:function(){}}),a.modules.Navigation=a.modules.Base.extend({topSelector:void 0,instanceId:void 0,init:function(e){if(this.$el&&!this.initialized()){var o=this;this.topSelector=a.modules.Navigation.widgetSelector,this.instanceId=Math.floor(1e8*Math.random()+1),this.topSelector=this.topSelector+"-"+this.instanceId,this.$el.className+=" "+this.topSelector.replace(/^\./,""),(this.$el.SkeletonWidget_Navigation=this).setState("loaded");for(var t=document.querySelectorAll(this.topSelector+" > .navLinks > .navLink > .navLinkAction"),n=0;n<t.length;n++)t[n].addEventListener("click",function(e){var t=e.target,n=i.El.hasClass(t,"navLinkSpecialToggle")?t:t.closest(".navLinkSpecialToggle"),t=i.El.hasClass(t,"navLinkAction")?t:t.closest(".navLinkAction");if(n)return e.preventDefault(),!1;o.handleLink(t.closest(".navLink"),e)});for(t=document.querySelectorAll(this.topSelector+" > .navLinks > .navLink > .navLinkAction .navLinkSpecialToggle"),n=0;n<t.length;n++)t[n].addEventListener("click",function(e){var t=i.El.hasClass(e.target,"navLinkSpecialToggle")?e.target:e.target.closest(".navLinkSpecialToggle");if(i.El.hasClass(t,"navLinkSpecialToggle"))return o.toggleSubMenu(t.closest(".navLinkSpecialAction")),e.preventDefault(),!1}),t[n].addEventListener("keydown",function(e){var t=i.El.hasClass(e.target,"navLinkSpecialToggle")?e.target:e.target.closest(".navLinkSpecialToggle");if(13==e.keyCode)return console.log("navLinkSpecialToggle:enter_key"),o.toggleSubMenu(t.closest(".navLinkSpecialAction")),e.preventDefault(),!1}),t[n].addEventListener("focusin",function(e){e=i.El.hasClass(e.target,"navLinkSpecialToggle")?e.target:e.target.closest(".navLinkSpecialToggle");i.El.addClass(e.closest(".navLinkAction"),"focus")}),t[n].addEventListener("focusout",function(e){e=i.El.hasClass(e.target,"navLinkSpecialToggle")?e.target:e.target.closest(".navLinkSpecialToggle");i.El.removeClass(e.closest(".navLinkAction"),"focus")});for(t=document.querySelectorAll(this.topSelector+" > .navLinks > .navLink > .navLinkAction"),n=0;n<t.length;n++)t[n].addEventListener("keydown",function(e){var t=i.El.hasClass(e.target,"navLinkAction")?e.target:e.target.closest(".navLinkAction");13==e.keyCode&&(console.log("navLinkAction:enter_key"),o.handleLink(t.closest(".navLink"),e))});this.toggleSubMenuTimeout=i.fn.debounce(function(){for(var e=o.$el.querySelectorAll(".navLinkSpecialContent"),t=0;t<e.length;t++){e[t].style.height="auto";var n=e[t].closest(".navLinkSpecialAction");if(n)for(var i=n.querySelectorAll(".navLinkSpecialContent .navLinkAction"),a=0;a<i.length;a++)"closed"==n.getAttribute("data-sub-state")?i[a].setAttribute("tabindex","-1"):i[a].setAttribute("tabindex","0")}},400)}},toggleSubMenu:function(e){var t=this,n=(e.querySelector(".navLinkAction"),e.querySelector(".navLinkSpecialContent > .page-skeleton-menu").offsetHeight);"closed"==e.getAttribute("data-sub-state")?(e.querySelector(".navLinkSpecialContent").style.height=n+"px",e.setAttribute("data-sub-state","opened"),this.toggleSubMenuTimeout()):(e.querySelector(".navLinkSpecialContent").style.height=n+"px",setTimeout(function(){e.setAttribute("data-sub-state","closed"),t.toggleSubMenuTimeout()},50))},handleLink:function(e,t){var n=e.querySelector(".navLinkAction");n.getAttribute("data-href")?(window.innerWidth<600&&document.querySelector(".page-skeleton").SkeletonWidget_Skeleton.closePageMenu(),t.ctrlKey||t.metaKey||"_blank"==n.getAttribute("data-target")?(window.open(n.getAttribute("data-href"),"_blank"),t.preventDefault()):location=n.getAttribute("data-href")):!n.getAttribute("href")&&i.El.hasClass(e,"navLinkSpecialAction")&&(this.toggleSubMenu(e),t.preventDefault())}},{widgetSelector:".page-skeleton-menu",initWidgets:function(){for(var e=document.querySelectorAll(a.modules.Navigation.widgetSelector),t=0;t<e.length;t++)a.modules.Navigation.initWidget(e[t])},initWidget:function(e){return new a.modules.Navigation({el:e})}}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(this))return null;do{if(t.matches(e))return t}while(null!==(t=t.parentElement));return null}),a.modules.Skeleton=a.modules.Base.extend({events:void 0,nvpWidth:608,$pageMenuAction:void 0,$memberMenuAction:void 0,$appMenuAction:void 0,$sideMenuAction:void 0,$pageMenuWrap:void 0,$memberMenuWrap:void 0,$appMenuWrap:void 0,$sideMenuWrap:void 0,$pageContentWrap:void 0,init:function(e){var t,n=this;this.$el&&!this.initialized()&&((this.$el.SkeletonWidget_Skeleton=this).setState("loaded"),this.events={pageMenuClick:[],pageMenuOpen:[],pageMenuClose:[],pageMenuToggle:[],memberMenuClick:[],memberMenuOpen:[],memberMenuClose:[],memberMenuToggle:[],appMenuClick:[],appMenuOpen:[],appMenuClose:[],appMenuToggle:[],sideMenuClick:[],sideMenuOpen:[],sideMenuClose:[],sideMenuToggle:[]},this.$pageMenuAction=this.$el.querySelector(".page-header .header-nav-action"),this.$memberMenuAction=this.$el.querySelector(".page-header .header-member-toggle"),this.$appMenuAction=this.$el.querySelector(".page-header .header-app-menu-action"),this.$sideMenuAction=this.$el.querySelector(".page-header .header-side-menu-action"),this.$pageMenuWrap=this.$el.querySelector(".page-menu"),this.$memberMenuWrap=this.$el.querySelector(".page-header-menu"),this.$appMenuWrap=this.$el.querySelector(".page-app-menu"),this.$sideMenuWrap=this.$el.querySelector(".page-side-menu"),this.$pageContentWrap=this.$el.querySelector(".page-content-wrap"),this.$pageMenuAction&&this.$pageMenuAction.addEventListener("click",function(){n.trigger("pageMenuClick"),n.handlePageMenuClick()}),this.$memberMenuAction&&(this.$memberMenuAction.addEventListener("click",function(){n.trigger("memberMenuClick"),n.handleMemberMenuClick()}),this.$memberMenuAction.addEventListener("keydown",function(e){9===e.keyCode&&0==e.shiftKey&&"opened"==n.$el.getAttribute("data-member-menu-state")&&setTimeout(function(){n.$memberMenuWrap.querySelector(".navLink.nl-2 .navLinkAction").focus()},1)})),!this.$memberMenuWrap||(t=this.$memberMenuWrap.querySelector(".navLink.nl-1 .navLinkAction"))&&t.addEventListener("keydown",function(e){9===e.keyCode&&!0===e.shiftKey&&setTimeout(function(){n.$memberMenuAction.focus()},1)}),this.$sideMenuAction&&this.$sideMenuAction.addEventListener("click",function(){n.trigger("sideMenuClick"),n.handleSideMenuClick()}),this.$appMenuAction&&this.$appMenuAction.addEventListener("click",function(){n.trigger("appMenuClick"),n.handleAppMenuClick()}),(t=this.$el.querySelector(".menu-toggle.main-menu-toggle"))&&t.addEventListener("click",function(){n.handlePageMenuClick()}),(t=this.$el.querySelector(".menu-toggle.side-menu-toggle"))&&t.addEventListener("click",function(){n.handleSideMenuClick()}),window.addEventListener("resize",function(e){window.innerWidth<n.nvpWidth&&"opened"==n.$el.getAttribute("data-menu-state")&&"opened"==n.$el.getAttribute("data-side-menu-state")&&n.closeSideMenu(),n.adjustBrandingMaxWidth()}),n.adjustBrandingMaxWidth(),window.addEventListener("click",function(e){e=e.target;"opened"==n.$el.getAttribute("data-member-menu-state")&&(e.closest(".page-header-menu")||e.closest(".header-member-toggle")||n.closeMemberMenu()),"opened"==n.$el.getAttribute("data-app-menu-state")&&(e.closest(".page-app-menu")||e.closest(".header-app-menu-action")||n.closeAppMenu())}))},adjustBrandingMaxWidth:function(){var e=0,t=[".header-nav-action",".header-app-menu-toggle",".header-member-menu",".header-side-menu-toggle",".app-menu-spacer",".header-menu-spacer"],n=this.$el.querySelector(".page-header .header-branding h2");if(n){for(var i=0;i<t.length;i++){var a=document.querySelector(t[i]);a&&(e+=a.offsetWidth,e+=parseInt(getComputedStyle(a)["margin-right"],10))}n.style["max-width"]="calc(100vw - "+e+"px)"}},handlePageMenuClick:function(){var e=this;"closed"==e.$el.getAttribute("data-menu-state")?("opened"==e.$el.getAttribute("data-side-menu-state")&&window.innerWidth<e.nvpWidth&&e.closeSideMenu(),e.openPageMenu()):e.closePageMenu()},handleMemberMenuClick:function(){"closed"==this.$el.getAttribute("data-member-menu-state")?this.openMemberMenu():this.closeMemberMenu()},handleAppMenuClick:function(){"closed"==this.$el.getAttribute("data-app-menu-state")?this.openAppMenu():this.closeAppMenu()},handleSideMenuClick:function(){var e=this;"closed"==e.$el.getAttribute("data-side-menu-state")?("opened"==e.$el.getAttribute("data-menu-state")&&window.innerWidth<e.nvpWidth&&e.closePageMenu(),e.openSideMenu()):e.closeSideMenu()},openPageMenu:function(){var e=this;e.$el.setAttribute("data-menu-state","opened"),e.$pageMenuAction.querySelector(".nav-label").innerHTML="Close Page Navigation",e.$pageMenuWrap.querySelector(".inner-wrap").scrollTop=0,e.trigger("pageMenuOpen"),e.trigger("pageMenuToggle",{type:"open"})},closePageMenu:function(){this.$el.setAttribute("data-menu-state","closed"),this.$pageMenuAction.querySelector(".nav-label").innerHTML="Open Page Navigation",this.trigger("pageMenuCLose"),this.trigger("pageMenuToggle",{type:"close"})},openMemberMenu:function(){var e=this;e.$el.setAttribute("data-member-menu-state","opened"),e.$memberMenuAction.querySelector(".member-menu-sro").innerHTML="Close Member Menu",e.$memberMenuWrap.querySelector(".inner-wrap").scrollTop=0,e.$memberMenuWrap.querySelector(".inner-wrap").focus(),e.trigger("memberMenuOpen"),e.trigger("memberMenuToggle",{type:"open"})},closeMemberMenu:function(){this.$el.setAttribute("data-member-menu-state","closed"),this.$memberMenuAction.querySelector(".member-menu-sro").innerHTML="Open Member Menu",this.trigger("memberMenuClose"),this.trigger("memberMenuToggle",{type:"close"})},openAppMenu:function(){var e=this;e.$el.setAttribute("data-app-menu-state","opened"),e.$appMenuAction.querySelector(".nav-label").innerHTML="Close App Menu",e.$appMenuWrap.querySelector(".inner-wrap").scrollTop=0,e.trigger("appMenuOpen"),e.trigger("appMenuToggle",{type:"open"})},closeAppMenu:function(){this.$el.setAttribute("data-app-menu-state","closed"),this.$appMenuAction.querySelector(".nav-label").innerHTML="Open App Menu",this.trigger("appMenuClose"),this.trigger("appMenuToggle",{type:"close"})},openSideMenu:function(){var e=this;e.$el.setAttribute("data-side-menu-state","opened"),e.$sideMenuAction.querySelector(".nav-label").innerHTML="Close Side Menu",e.$sideMenuAction.querySelector(".nav-icon svg g").setAttribute("transform","rotate(180, 18, 32)"),e.$sideMenuWrap.querySelector(".inner-wrap").scrollTop=0,e.trigger("sideMenuOpen"),e.trigger("sideMenuToggle",{type:"open"})},closeSideMenu:function(){var e=this;e.$el.setAttribute("data-side-menu-state","closed"),e.$sideMenuAction.querySelector(".nav-label").innerHTML="Open Side Menu",e.$sideMenuAction.querySelector(".nav-icon svg g").setAttribute("transform",""),e.trigger("sideMenuClose"),e.trigger("sideMenuToggle",{type:"close"})}},{widgetSelector:".page-skeleton",initWidgets:function(){for(var e=document.querySelectorAll(a.modules.Skeleton.widgetSelector),t=0;t<e.length;t++)a.modules.Skeleton.initWidget(e[t])},initWidget:function(e){return new a.modules.Skeleton({el:e})}}),a});